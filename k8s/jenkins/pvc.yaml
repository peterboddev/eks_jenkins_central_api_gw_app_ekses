apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: jenkins-home
  namespace: jenkins
  labels:
    app: jenkins-controller
    component: storage
spec:
  # Access mode: ReadWriteMany allows multiple pods to mount the volume
  # Requirement 6.9: Persistent volume SHALL use ReadWriteMany access mode
  # Requirement 3.2: Jenkins controller SHALL use persistent volume backed by EFS
  accessModes:
  - ReadWriteMany
  
  # Storage class: jenkins-efs (static PV created by CDK)
  # Requirement 6.1: Persistent volume SHALL use EFS as storage backend
  # This binds to the static PV created by CDK, no CSI driver needed
  storageClassName: jenkins-efs
  
  # Storage request: 100Gi (symbolic size, EFS grows automatically)
  # Requirement 3.2: Mount to /var/jenkins_home
  resources:
    requests:
      storage: 100Gi
  
  # Selector to bind to the specific PV created by CDK
  selector:
    matchLabels:
      app: jenkins
      type: efs
